name: Send release notes to Beamer
on:
  release:
    types: [published]
jobs:
  send-release-notes:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v2
      - name: Send release notes to Beamer
        run: |
          TAG=$(echo ${{ github.event.release.tag_name }})
          RELEASE_NOTES=$(echo ${{ github.event.release.body }})
          response=$(curl -H "Content-Type: application/json" \
               -H "X-Beamer-Api-Key: ${{ secrets.BEAMER_API_KEY }}" \
               -X POST \
               -d "{\"title\": \"Release $TAG\", \"description\": \"$RELEASE_NOTES\"}" \
               https://app.getbeamer.com/akto8998/updates/updates)
          echo $response
